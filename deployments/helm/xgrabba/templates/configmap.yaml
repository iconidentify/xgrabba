apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "xgrabba.fullname" . }}
  labels:
    {{- include "xgrabba.labels" . | nindent 4 }}
data:
  SERVER_HOST: {{ .Values.config.server.host | quote }}
  SERVER_PORT: {{ .Values.config.server.port | quote }}
  SERVER_READ_TIMEOUT: {{ .Values.config.server.readTimeout | quote }}
  SERVER_WRITE_TIMEOUT: {{ .Values.config.server.writeTimeout | quote }}
  STORAGE_PATH: {{ .Values.config.storage.basePath | quote }}
  STORAGE_TEMP_PATH: {{ .Values.config.storage.tempPath | quote }}
  MAX_FILE_SIZE: "{{ .Values.config.storage.maxFileSize | int64 }}"
  WORKER_COUNT: {{ .Values.config.worker.count | quote }}
  WORKER_POLL_INTERVAL: {{ .Values.config.worker.pollInterval | quote }}
  WORKER_MAX_RETRIES: {{ .Values.config.worker.maxRetries | quote }}
  GROK_BASE_URL: {{ .Values.config.grok.baseUrl | quote }}
  GROK_TIMEOUT: {{ .Values.config.grok.timeout | quote }}
  GROK_MODEL: {{ .Values.config.grok.model | quote }}
  WHISPER_ENABLED: {{ .Values.config.whisper.enabled | quote }}
  WHISPER_BASE_URL: {{ .Values.config.whisper.baseUrl | quote }}
  WHISPER_TIMEOUT: {{ .Values.config.whisper.timeout | quote }}
  WHISPER_MODEL: {{ .Values.config.whisper.model | quote }}
  AI_REGENERATE_TIMEOUT: {{ .Values.config.ai.regenerateTimeout | quote }}
  BOOKMARKS_ENABLED: {{ .Values.config.bookmarks.enabled | quote }}
  BOOKMARKS_USER_ID: {{ .Values.config.bookmarks.userId | quote }}
  BOOKMARKS_BASE_URL: {{ .Values.config.bookmarks.baseUrl | quote }}
  BOOKMARKS_POLL_INTERVAL: {{ .Values.config.bookmarks.pollInterval | quote }}
  BOOKMARKS_MAX_RESULTS: {{ .Values.config.bookmarks.maxResults | quote }}
  BOOKMARKS_MAX_NEW_PER_POLL: {{ .Values.config.bookmarks.maxNewPerPoll | quote }}
  BOOKMARKS_SEEN_TTL: {{ .Values.config.bookmarks.seenTtl | quote }}
  BOOKMARKS_OAUTH_STORE_PATH: {{ .Values.config.bookmarks.oauthStorePath | quote }}
  TWITTER_OAUTH_CLIENT_ID: {{ .Values.config.bookmarks.oauthClientId | quote }}
  TWITTER_OAUTH_TOKEN_URL: {{ .Values.config.bookmarks.tokenUrl | quote }}
  DOWNLOAD_TIMEOUT: {{ .Values.config.download.timeout | quote }}
  DOWNLOAD_RETRY_DELAY: {{ .Values.config.download.retryDelay | quote }}
  DOWNLOAD_MAX_RETRY_DELAY: {{ .Values.config.download.maxRetryDelay | quote }}
  {{- if .Values.usbManager.enabled }}
  USB_ENABLED: "true"
  USB_MANAGER_URL: "http://{{ include "xgrabba.fullname" . }}-usb-manager:8080"
  USB_EXPORT_PATH: {{ .Values.usbManager.exportPath | quote }}
  {{- end }}
